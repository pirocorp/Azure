# Enhance a web application by using the Azure Content Delivery Network


# Architecture diagram

![image](https://user-images.githubusercontent.com/34960418/169562432-3c771d27-da09-4075-b662-2a55bdcc2763.png)


# Create Azure resources

## Open the [Azure portal](https://portal.azure.com/)


## Create a Storage account

In the Azure portal, use the **Search resources, services, and docs** text box to search for **Storage account**, and then in the list of results, select **Storage account**. On the **Storage account** blade, select **+ Create**.

![image](https://user-images.githubusercontent.com/34960418/169645634-3a3d108d-a44e-40b6-9118-ba3e59a98c4e.png)


On the **Create a storage account** blade, on the **Basics** tab, perform the following actions, and then select **Review + create**.

| Setting                           | Action                                                       |
| --------------------------------- | ------------------------------------------------------------ |
| **Subscription** drop-down list   | Retain the default value.                                    |
| **Resource group** section        | Select **Create new**, enter **MarketingContent**, and then select **OK**. |
| **Storage account name** text box | Enter **contenthost**_[yourname]_.                           |
| **Region** drop-down list         | Select **(US) East US**.                                     |
| **Performance** section           | Select the **Standard** option.                              |
| **Redundancy** drop-down list     | Select **Locally-redundant storage (LRS)**.                  |

The following screenshot displays the configured settings in the **Create a storage account** blade.

![image](https://user-images.githubusercontent.com/34960418/169645667-5f1fa7c6-cc22-4096-b207-d34af97b5a7f.png)


On the **Review + create** tab, review the options that you selected during the previous steps. Select **Create** to create the storage account by using your specified configuration.

> **Note**: Wait for the creation task to complete before you move forward with this lab.


## Create a web app by using Azure App Service

On the Azure portal's navigation pane, select **Create a resource**. On the **Create a resource** blade, in the **Search services and marketplace** text box, enter **Web App**, and then select Enter. On the search results blade, select the **Web App** result, and then select **Create**.

![image](https://user-images.githubusercontent.com/34960418/169645732-d7c756aa-2e77-45e8-b8a8-2fdcf68fde36.png)


On the **Create Web App** blade, on the **Basics** tab, perform the following actions, and then select **Next: Docker**:

| Setting                           | Action                                                       |
| --------------------------------- | ------------------------------------------------------------ |
| **Subscription** drop-down list   | Retain the default value.                                    |
| **Resource group** drop-down list | Select **MarketingContent** in the list.                     |
| **Name** text box                 | Enter **landingpage**_[yourname]_.                           |
| **Publish** section               | Select **Docker Container**.                                 |
| **Operating System** section      | Select **Linux**.                                            |
| **Region** drop-down list         | Select **East US**.                                          |
| **Linux Plan (East US)** section  | Select **Create new**. In the **Name** text box, enter **MarketingPlan**, and then select **OK**. |
| **SKU and size** section          | Retain the default value.                                    |

The following screenshot displays the configured settings on the **Create Web App** blade.

![image](https://user-images.githubusercontent.com/34960418/169645843-fcf9b583-68ed-4d7d-aaba-bfef6e8453f7.png)


On the **Docker** tab, perform the following actions, and then select **Review + create**:

| Setting                         | Action                                                    |
| ------------------------------- | --------------------------------------------------------- |
| **Options** drop-down list      | Select **Single Container**.                              |
| **Image Source** drop-down list | Select **Docker Hub**.                                    |
| **Access Type** drop-down list  | Select **Public**.                                        |
| **Image and tag** text box      | Enter **microsoftlearning/edx-html-landing-page:latest**. |

The following screenshot displays the configured settings on the **Docker** tab.

![image](https://user-images.githubusercontent.com/34960418/169645895-0fd56399-5d6a-4a94-aa27-70b2a56bed02.png)


On the **Review + create** tab, review the options that you selected during the previous steps. Select **Create** to create the web app by using your specified configuration.

> **Note**: Wait for the creation task to complete before you move forward with this lab.


On the **Deployment** blade, select **Go to resource**. On the **App Service Overview** blade, in the **Essentials**, record the value of the **URL** link. You'll use this value later in the lab.

![image](https://user-images.githubusercontent.com/34960418/169645975-368ebc50-d397-4ff7-af81-365935fd36af.png)


## Review

In this exercise, you created an Azure Storage account and an Azure Web App that you'll use later in this lab.


# Configure Content Delivery Network and endpoints

## Open Azure CLI

Run the following command to get the version of the Azure Command-Line Interface (Azure CLI) tool:

```bash
az --version
```

![image](https://user-images.githubusercontent.com/34960418/169646072-3b45d458-c1c2-48b2-b333-019a06be5163.png)


## Register the Microsoft.CDN provider

Enter the following command, and then select Enter to get a list of subgroups and commands at the root level of the Azure CLI:

```bash
az --help
```

![image](https://user-images.githubusercontent.com/34960418/169646122-a15de192-f5bb-4704-b09e-e30d3639b121.png)


Enter the following command, and then select Enter to get a list of the commands that are available for resource providers:

```bash
az provider --help
```

![image](https://user-images.githubusercontent.com/34960418/169646153-0394bd3c-911c-4487-8f15-e5a3fa8041a3.png)


Enter the following command, and then select Enter to list all currently registered providers:

```bash
az provider list -o table
```

![image](https://user-images.githubusercontent.com/34960418/169646229-9df03301-4388-409d-9f6d-18c4e416b8f4.png)


Enter the following command, and then select Enter to list only the namespaces of the currently registered providers:

```bash
az provider list --query "[?registrationState=='Registered'].namespace"
```

Observe the list of currently registered providers. The **Microsoft.CDN** provider isn't currently in the list of providers.

![image](https://user-images.githubusercontent.com/34960418/169646272-25d69d90-a991-4b22-9f72-78c3cf405485.png)


Enter the following command, and then select Enter to get the required flags to register a new provider:

```bash
az provider register --help
```

![image](https://user-images.githubusercontent.com/34960418/169646302-e27c3419-f803-4276-a001-a1e726823c91.png)


Enter the following command, and then select Enter to register the **Microsoft.CDN** namespace with your current subscription:

```bash
az provider register --namespace Microsoft.CDN
```

![image](https://user-images.githubusercontent.com/34960418/169646347-6d45e340-cce3-491e-a7e2-6cae04b5dc2b.png)

![image](https://user-images.githubusercontent.com/34960418/169646361-c7c7c7dc-12c6-4c7b-861c-f5ae3665797f.png)

