# Authenticate by using OpenID Connect MSAL and .NET SDKs

# Architecture diagram

![image](https://user-images.githubusercontent.com/34960418/168565954-5d482ecb-bea6-493c-a0cd-92c0874385ec.png)


# Configure a single-tenant Azure AD environment

## Open the [Azure portal](https://portal.azure.com)


## Register an application in Azure AD

In the Azure portal, use the **Search resources, services, and docs** text box to search for **Azure Active Directory** and, in the list of results, select **Azure Active Directory**.

> **Note**: This redirects your browser session to the blade of the Azure Active Directory (Azure AD) tenant associated with your Azure subscription.

![image](https://user-images.githubusercontent.com/34960418/168567488-37368474-fb89-4003-9e6a-449439c735a0.png)


On the **Azure Active Directory** blade, select **App registrations** in the **Manage** section. In the **App registrations** section, select **+ New registration**.

![image](https://user-images.githubusercontent.com/34960418/168568012-fc4c5b1f-104a-4d9f-8718-94f9832d00eb.png)


In the **Register an application** section, perform the following actions, and then select **Register**:

| Setting | Action |
| --- | --- |
| **Name** text box | Enter **webappoidc** |
| **Supported account types** list | Select **Accounts in this organizational directory only (Default Directory only - Single tenant)** |

The following screenshot displays the configured settings in the **Register an application** section.

![image](https://user-images.githubusercontent.com/34960418/168568441-191e74b6-587a-40b0-84bd-375e060e6418.png)


## Record unique identifiers

On the **webappoidc** application registration blade, select **Overview**. In the **Overview** section, find and record the value of the **Application (client) ID** text box. You'll use this value later in the lab. In the **Overview** section, find and record the value of the **Directory (tenant) ID** text box. You'll use this value later in the lab.

![image](https://user-images.githubusercontent.com/34960418/168594573-65e0d8da-238a-4928-8080-9fb83055635d.png)


## Configure the application authentication settings

On the **webappoidc** application registration blade, select **Authentication** in the **Manage** section. 

![image](https://user-images.githubusercontent.com/34960418/168595289-a4071cf1-249d-4f97-a986-e69663f9650c.png)


In the **Authentication** section, perform the following actions, and select **Configure**:

| Setting | Action |
| --- | --- |
| **Platform configurations** section | Select **+ Add a platform** |
| **Configure platforms** blade  | Select **Web** |
| **Redirect URIs** text box | Enter `https://localhost:44321/` |
| **Front-channel logout URL** text box   | Enter  `https://localhost:44321/signout-oidc` |
|**Implicit grant and hybrid flows** section | Select **ID tokens (used for implicit and hybrid  flows)** |

![image](https://user-images.githubusercontent.com/34960418/168596617-0b24c9a4-46a1-402e-95d7-346f5f44e13a.png)


Back in the **Platform configurations** section, select **Add URI**, and then enter `https://localhost:44321/signin-oidc`. Select **Save**. The following screenshot displays the configured settings on the **Authentication** blade.

![image](https://user-images.githubusercontent.com/34960418/168597299-6dd5c140-a96c-4868-9a82-3256844cf545.png)


## Create an Azure AD user

Run the following command to sign in to Azure Account

```powershell
Connect-AzAccount
```

Run the following command to sign in to the Azure AD tenant associated with your Azure subscription:

```powershell
Connect-AzureAD
```

![image](https://user-images.githubusercontent.com/34960418/168607315-b3c94a04-e99a-4aa2-b6c8-ba849fbccef5.png)


Run the following command to retrieve and display the primary Domain Name System (DNS) domain name of the Azure AD tenant:

```powershell
$AAD_DOMAIN_NAME = ((Get-AzureAdTenantDetail).VerifiedDomains)[0].Name
$AAD_DOMAIN_NAME
```
